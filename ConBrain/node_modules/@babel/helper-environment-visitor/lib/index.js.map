{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import type { NodePath, Visitor } from \"@babel/traverse\";\nimport type * as t from \"@babel/types\";\n\nif (!process.env.BABEL_8_BREAKING && !USE_ESM && !IS_STANDALONE) {\n  // eslint-disable-next-line no-restricted-globals\n  exports.skipAllButComputedKey = function skipAllButComputedKey(\n    path: NodePath<t.Method | t.ClassProperty>,\n  ) {\n    path.skip();\n    if (path.node.computed) {\n      // requeue the computed key\n      path.context.maybeQueue(path.get(\"key\"));\n    }\n  };\n}\n\nexport function requeueComputedKeyAndDecorators(\n  path: NodePath<t.Method | t.Property>,\n) {\n  const { context, node } = path;\n  // @ts-expect-error ClassPrivateProperty does not have computed\n  if (node.computed) {\n    // requeue the computed key\n    context.maybeQueue(path.get(\"key\"));\n  }\n  if (node.decorators) {\n    for (const decorator of path.get(\"decorators\")) {\n      // requeue the decorators\n      context.maybeQueue(decorator);\n    }\n  }\n}\n\n// environmentVisitor should be used when traversing the whole class and not for specific class elements/methods.\n// For perf reasons, the environmentVisitor might be traversed with `{ noScope: true }`, which means `path.scope` is undefined.\n// Avoid using `path.scope` here\nconst visitor: Visitor = {\n  FunctionParent(path) {\n    if (path.isArrowFunctionExpression()) {\n      // arrows are not skipped because they inherit the context.\n      return;\n    } else {\n      path.skip();\n      if (path.isMethod()) {\n        requeueComputedKeyAndDecorators(path);\n      }\n    }\n  },\n  Property(path) {\n    if (path.isObjectProperty()) {\n      return;\n    }\n    path.skip();\n    requeueComputedKeyAndDecorators(path);\n  },\n};\n\nexport default visitor;\n"],"names":["requeueComputedKeyAndDecorators","path","context","node","computed","maybeQueue","get","decorators","decorator","visitor","FunctionParent","isArrowFunctionExpression","skip","isMethod","Property","isObjectProperty"],"mappings":"AAgBO,SAASA,+BAA+BA,CAC7CC,IAAqC,EACrC;EACA,MAAM;IAAEC,OAAO;AAAEC,IAAAA,IAAAA;AAAK,GAAC,GAAGF,IAAI,CAAA;EAE9B,IAAIE,IAAI,CAACC,QAAQ,EAAE;IAEjBF,OAAO,CAACG,UAAU,CAACJ,IAAI,CAACK,GAAG,CAAC,KAAK,CAAC,CAAC,CAAA;AACrC,GAAA;EACA,IAAIH,IAAI,CAACI,UAAU,EAAE;IACnB,KAAK,MAAMC,SAAS,IAAIP,IAAI,CAACK,GAAG,CAAC,YAAY,CAAC,EAAE;AAE9CJ,MAAAA,OAAO,CAACG,UAAU,CAACG,SAAS,CAAC,CAAA;AAC/B,KAAA;AACF,GAAA;AACF,CAAA;AAKA,MAAMC,OAAgB,GAAG;EACvBC,cAAcA,CAACT,IAAI,EAAE;AACnB,IAAA,IAAIA,IAAI,CAACU,yBAAyB,EAAE,EAAE;AAEpC,MAAA,OAAA;AACF,KAAC,MAAM;MACLV,IAAI,CAACW,IAAI,EAAE,CAAA;AACX,MAAA,IAAIX,IAAI,CAACY,QAAQ,EAAE,EAAE;QACnBb,+BAA+B,CAACC,IAAI,CAAC,CAAA;AACvC,OAAA;AACF,KAAA;GACD;EACDa,QAAQA,CAACb,IAAI,EAAE;AACb,IAAA,IAAIA,IAAI,CAACc,gBAAgB,EAAE,EAAE;AAC3B,MAAA,OAAA;AACF,KAAA;IACAd,IAAI,CAACW,IAAI,EAAE,CAAA;IACXZ,+BAA+B,CAACC,IAAI,CAAC,CAAA;AACvC,GAAA;AACF;;;;"}